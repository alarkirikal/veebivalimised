function sortables_init(){if(!document.getElementsByTagName)return;tbls=document.getElementsByTagName("table");for(ti=0;ti<tbls.length;ti++){thisTbl=tbls[ti];if((" "+thisTbl.className+" ").indexOf("data")!=-1&&thisTbl.id){ts_makeSortable(thisTbl)}}}function ts_makeSortable(e){if(e.rows&&e.rows.length>0){if(e.tHead&&e.tHead.rows.length>0){var t=e.tHead.rows[e.tHead.rows.length-1];thead=true}else{var t=e.rows[0]}}if(!t)return;for(var n=0;n<t.cells.length;n++){var r=t.cells[n];var i=ts_getInnerText(r);if(r.className!="unsortable"&&r.className.indexOf("unsortable")==-1){r.innerHTML='<div class="sortheader" onclick="ts_resortTable(this, '+n+');return false;">'+i+'<span class="sortarrow">  <img src="'+image_path+image_none+'" alt="?" width = "16px" height = "10px"/></span></div>'}}if(alternate_row_colors){alternate(e)}}function ts_getInnerText(e){if(typeof e=="string")return e;if(typeof e=="undefined"){return e}if(e.innerText)return e.innerText;var t="";var n=e.childNodes;var r=n.length;for(var i=0;i<r;i++){switch(n[i].nodeType){case 1:t+=ts_getInnerText(n[i]);break;case 3:t+=n[i].nodeValue;break}}return t}function ts_resortTable(e,t){var n;for(var r=0;r<e.childNodes.length;r++){if(e.childNodes[r].tagName&&e.childNodes[r].tagName.toLowerCase()=="span")n=e.childNodes[r]}var i=ts_getInnerText(n);var s=e.parentNode;var o=t||s.cellIndex;var u=getParent(s,"TABLE");if(u.rows.length<=1)return;var a="";var f=0;while(a==""&&f<u.tBodies[0].rows.length){var a=ts_getInnerText(u.tBodies[0].rows[f].cells[o]);a=trim(a);if(a.substr(0,4)=="<!--"||a.length==0){a=""}f++}if(a=="")return;sortfn=ts_sort_caseinsensitive;if(a.match(/^\d\d[\/\.-][a-zA-z][a-zA-Z][a-zA-Z][\/\.-]\d\d\d\d$/))sortfn=ts_sort_date;if(a.match(/^\d\d[\/\.-]\d\d[\/\.-]\d\d\d{2}?$/))sortfn=ts_sort_date;if(a.match(/^-?[£$€Û¢´]\d/))sortfn=ts_sort_numeric;if(a.match(/^-?(\d+[,\.]?)+(E[-+][\d]+)?%?$/))sortfn=ts_sort_numeric;SORT_COLUMN_INDEX=o;var l=new Array;var c=new Array;for(k=0;k<u.tBodies.length;k++){for(f=0;f<u.tBodies[k].rows[0].length;f++){l[f]=u.tBodies[k].rows[0][f]}}for(k=0;k<u.tBodies.length;k++){if(!thead){for(j=1;j<u.tBodies[k].rows.length;j++){c[j-1]=u.tBodies[k].rows[j]}}else{for(j=0;j<u.tBodies[k].rows.length;j++){c[j]=u.tBodies[k].rows[j]}}}c.sort(sortfn);if(n.getAttribute("sortdir")=="down"){ARROW='<img src="'+image_path+image_down+'" alt="?" width = "16px" height = "10px"/>';c.reverse();n.setAttribute("sortdir","up")}else{ARROW='<img src="'+image_path+image_up+'" alt="?" width = "16px" height = "10px"/>';n.setAttribute("sortdir","down")}for(f=0;f<c.length;f++){if(!c[f].className||c[f].className&&c[f].className.indexOf("sortbottom")==-1){u.tBodies[0].appendChild(c[f])}}for(f=0;f<c.length;f++){if(c[f].className&&c[f].className.indexOf("sortbottom")!=-1)u.tBodies[0].appendChild(c[f])}var h=document.getElementsByTagName("span");for(var r=0;r<h.length;r++){if(h[r].className=="sortarrow"){if(getParent(h[r],"table")==getParent(e,"table")){h[r].innerHTML='  <img src="'+image_path+image_none+'" alt="?" width = 16px height = 10px/>'}}}n.innerHTML=ARROW;alternate(u)}function getParent(e,t){if(e==null){return null}else if(e.nodeType==1&&e.tagName.toLowerCase()==t.toLowerCase()){return e}else{return getParent(e.parentNode,t)}}function sort_date(e){dt="00000000";if(e.length==11){mtstr=e.substr(3,3);mtstr=mtstr.toLowerCase();switch(mtstr){case"jan":var t="01";break;case"feb":var t="02";break;case"mar":var t="03";break;case"apr":var t="04";break;case"may":var t="05";break;case"jun":var t="06";break;case"jul":var t="07";break;case"aug":var t="08";break;case"sep":var t="09";break;case"oct":var t="10";break;case"nov":var t="11";break;case"dec":var t="12";break}dt=e.substr(7,4)+t+e.substr(0,2);return dt}else if(e.length==10){if(europeandate==false){dt=e.substr(6,4)+e.substr(0,2)+e.substr(3,2);return dt}else{dt=e.substr(6,4)+e.substr(3,2)+e.substr(0,2);return dt}}else if(e.length==8){yr=e.substr(6,2);if(parseInt(yr)<50){yr="20"+yr}else{yr="19"+yr}if(europeandate==true){dt=yr+e.substr(3,2)+e.substr(0,2);return dt}else{dt=yr+e.substr(0,2)+e.substr(3,2);return dt}}return dt}function ts_sort_date(e,t){dt1=sort_date(ts_getInnerText(e.cells[SORT_COLUMN_INDEX]));dt2=sort_date(ts_getInnerText(t.cells[SORT_COLUMN_INDEX]));if(dt1==dt2){return 0}if(dt1<dt2){return-1}return 1}function ts_sort_numeric(e,t){var n=ts_getInnerText(e.cells[SORT_COLUMN_INDEX]);n=clean_num(n);var r=ts_getInnerText(t.cells[SORT_COLUMN_INDEX]);r=clean_num(r);return compare_numeric(n,r)}function compare_numeric(e,t){var e=parseFloat(e);e=isNaN(e)?0:e;var t=parseFloat(t);t=isNaN(t)?0:t;return e-t}function ts_sort_caseinsensitive(e,t){aa=ts_getInnerText(e.cells[SORT_COLUMN_INDEX]).toLowerCase();bb=ts_getInnerText(t.cells[SORT_COLUMN_INDEX]).toLowerCase();if(aa==bb){return 0}if(aa<bb){return-1}return 1}function ts_sort_default(e,t){aa=ts_getInnerText(e.cells[SORT_COLUMN_INDEX]);bb=ts_getInnerText(t.cells[SORT_COLUMN_INDEX]);if(aa==bb){return 0}if(aa<bb){return-1}return 1}function addEvent(e,t,n,r){if(e.addEventListener){e.addEventListener(t,n,r);return true}else if(e.attachEvent){var i=e.attachEvent("on"+t,n);return i}else{alert("Handler could not be removed")}}function clean_num(e){e=e.replace(new RegExp(/[^-?0-9.]/g),"");return e}function trim(e){return e.replace(/^\s+|\s+$/g,"")}function alternate(e){var t=e.getElementsByTagName("tbody");for(var n=0;n<t.length;n++){var r=t[n].getElementsByTagName("tr");for(var i=0;i<r.length;i++){if(i%2==0){if(!(r[i].className.indexOf("odd")==-1)){r[i].className=r[i].className.replace("odd","even")}else{if(r[i].className.indexOf("even")==-1){r[i].className+=" even"}}}else{if(!(r[i].className.indexOf("even")==-1)){r[i].className=r[i].className.replace("even","odd")}else{if(r[i].className.indexOf("odd")==-1){r[i].className+=" odd"}}}}}}var image_path="";var image_up="Images/arrow-up.gif";var image_down="Images/arrow-down.gif";var image_none="Images/arrow-none.gif";var europeandate=true;var alternate_row_colors=true;addEvent(window,"load",sortables_init);var SORT_COLUMN_INDEX;var thead=false